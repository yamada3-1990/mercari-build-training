ãƒ¡ãƒ¢ã¨å‚è€ƒãƒªãƒ³ã‚¯ã¾ã¨ã‚
<!-- - [infra.go](#infra.go)
- [server.go](#server.go) -->

## infra.go

æ°¸ç¶šåŒ–ã®ãŸã‚ã®å‡¦ç†ãŒè²¬å‹™
-> ãƒ‡ãƒ¼ã‚¿ã‚’æ®‹ã—ã¦ãŠããŸã‚ã«ã€ä¿å­˜ã‚„èª­ã¿è¾¼ã¿ãªã©ã®å‡¦ç†ã‚’æ‹…å½“

### NewItemRepository()

* items tableã¨categories tableã‚’ä½œæˆ
* è¿”ã‚Šå€¤: `ItemRepository` (itemRepositoryã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹), `error` (ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)
* ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã€ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆã™ã‚‹ã€‚ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€nilã®ItemRepositoryã¨ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™

### Insert()

* ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŒ¿å…¥ã™ã‚‹å‡¦ç†
* å¼•æ•°: `ctx context.Context` (ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ), `item *Item` (æŒ¿å…¥ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ )
* è¿”ã‚Šå€¤: `error` (ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)
* ã‚«ãƒ†ã‚´ãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯æ–°è¦ä½œæˆã€ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŒ¿å…¥
* imageã®å¼•æ•°ãŒãªã‹ã£ãŸã‚‰default.jpgã‚’ä½¿ç”¨

### GetAll()

* å…¨ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã™ã‚‹å‡¦ç†
* å¼•æ•°: `ctx context.Context` (ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `[]Item` (ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ãƒ©ã‚¤ã‚¹), `error` (ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)
* itemsãƒ†ãƒ¼ãƒ–ãƒ«ã¨categoriesãƒ†ãƒ¼ãƒ–ãƒ«ã‚’INNER JOINã—ã¦å…¨ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—

### GetItemById()

* IDã‹ã‚‰ç‰¹å®šã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾—ã™ã‚‹å‡¦ç†
* å¼•æ•°: `ctx context.Context` (ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ), `item_id string` (å–å¾—ã™ã‚‹ã‚¢ã‚¤ãƒ†ãƒ ã®ID)
* è¿”ã‚Šå€¤: `Item` (ã‚¢ã‚¤ãƒ†ãƒ ), `error` (ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)
* æŒ‡å®šã•ã‚ŒãŸIDã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ã€ã‚¢ã‚¤ãƒ†ãƒ ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ `errItemNotFound` ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™

### SearchItemsByKeyword()

* ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ¤œç´¢ã™ã‚‹å‡¦ç†
* å¼•æ•°: `ctx context.Context` (ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ), `keyword string` (æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰)
* è¿”ã‚Šå€¤: `[]Item` (ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ãƒ©ã‚¤ã‚¹), `error` (ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)
* æŒ‡å®šã•ã‚ŒãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’åå‰ã«å«ã‚€ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æ¤œç´¢ã™ã‚‹ã€‚

### StoreImage()

* ç”»åƒã‚’ä¿å­˜ã™ã‚‹å‡¦ç†
* å¼•æ•°: `fileName string` (ãƒ•ã‚¡ã‚¤ãƒ«å), `image []byte` (ç”»åƒãƒ‡ãƒ¼ã‚¿)
* è¿”ã‚Šå€¤: `error` (ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)
* æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«å(SHA-256)ã§ç”»åƒã‚’ä¿å­˜



## server.go

HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ç­‰ã®ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€ãƒãƒ³ãƒ‰ãƒ©ã®ãƒ­ã‚¸ãƒƒã‚¯ç®¡ç†ãŒè²¬å‹™
-> HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã€ãã‚Œã«å¯¾ã™ã‚‹å¿œç­”HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã¾ã§ã®ä¸€é€£ã®å‡¦ç†ã‚’æ‹…å½“

### Run()

* HTTPã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å—ä»˜ã‚’é–‹å§‹ã™ã‚‹å‡¦ç†
* å¼•æ•°: `s Server` (ã‚µãƒ¼ãƒãƒ¼è¨­å®š)
* è¿”ã‚Šå€¤: `int` (ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•çµæœã€‚0ã¯æˆåŠŸã€1ã¯å¤±æ•—)

### Hello()

* GET `/` ã«å¯¾ã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ã€‚Hello, world! ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿”ã™ã€‚
* å¼•æ•°: `w http.ResponseWriter` (HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ©ã‚¤ã‚¿ãƒ¼), `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `ãªã—`

### GetItems()

* GET `/items` ã«å¯¾ã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ã€‚å…¨ã¦ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’JSONå½¢å¼ã§è¿”ã™ã€‚
* å¼•æ•°: `w http.ResponseWriter` (HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ©ã‚¤ã‚¿ãƒ¼), `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `ãªã—`

### AddItem()

* POST `/items` ã«å¯¾ã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ã€‚æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰å—ã‘å–ã‚Šã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æŒ¿å…¥ã™ã‚‹ã€‚
* å¼•æ•°: `w http.ResponseWriter` (HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ©ã‚¤ã‚¿ãƒ¼), `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `ãªã—`

### GetImage()

* GET `/images/{filename}` ã«å¯¾ã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ã€‚æŒ‡å®šã•ã‚ŒãŸç”»åƒã‚’è¿”ã™ã€‚ç”»åƒãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç”»åƒã‚’è¿”ã™ã€‚
* å¼•æ•°: `w http.ResponseWriter` (HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ©ã‚¤ã‚¿ãƒ¼), `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `ãªã—`

### GetItemById()

* GET `/items/{item_id}` ã«å¯¾ã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ã€‚IDã‹ã‚‰ç‰¹å®šã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’JSONå½¢å¼ã§è¿”ã™ã€‚
* å¼•æ•°: `w http.ResponseWriter` (HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ©ã‚¤ã‚¿ãƒ¼), `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `ãªã—`

### SearchItemsByKeyword()

* GET `/search?keyword={keyword}` ã«å¯¾ã™ã‚‹ãƒãƒ³ãƒ‰ãƒ©ã€‚ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã‚‰ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ¤œç´¢ã—ã€JSONå½¢å¼ã§è¿”ã™ã€‚
* å¼•æ•°: `w http.ResponseWriter` (HTTPãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ©ã‚¤ã‚¿ãƒ¼), `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `ãªã—`

### storeImage()

* ç”»åƒã‚’å—ã‘ã¨ã£ã¦ãƒãƒƒã‚·ãƒ¥å€¤ã‚’ãƒ•ã‚¡ã‚¤ãƒ«åã¨ã—ã¦ä¿å­˜ã™ã‚‹ã€‚
* å¼•æ•°: `image []byte` (ç”»åƒãƒ‡ãƒ¼ã‚¿)
* è¿”ã‚Šå€¤: `(string, error)` (ä¿å­˜ã•ã‚ŒãŸç”»åƒã®ãƒ‘ã‚¹, ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)

### parseAddItemRequest()

* POST `/items` ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è§£æã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚
* å¼•æ•°: `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `(*AddItemRequest, error)` (è§£æã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ, ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)

### parseGetImageRequest()

* GET `/images/{filename}` ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è§£æã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚
* å¼•æ•°: `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `(*GetImageRequest, error)` (è§£æã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ, ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)

### buildImagePath()

* ç”»åƒã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’æ§‹ç¯‰ã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚
* å¼•æ•°: `imageFileName string` (ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å)
* è¿”ã‚Šå€¤: `(string, error)` (æ§‹ç¯‰ã•ã‚ŒãŸç”»åƒãƒ‘ã‚¹, ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)

### parseGetItemByIdRequest()

* GET `/items/{item_id}` ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è§£æã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚
* å¼•æ•°: `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `(*GetItemByIdRequest, error)` (è§£æã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ, ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)

### parseGetItemByKeywordRequest()

* GET `/search?keyword={keyword}` ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è§£æã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¡Œã†ã€‚
* å¼•æ•°: `r *http.Request` (HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆ)
* è¿”ã‚Šå€¤: `(*GetItemByKeywordRequest, error)` (è§£æã•ã‚ŒãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆ, ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ)



## ğŸ”°
### STEP4: å‡ºå“APIã‚’ä½œã‚‹

**â“GETã¨POSTã®é•ã„ã«ã¤ã„ã¦èª¿ã¹ã¦ã¿ã¾ã—ã‚‡ã†**
* GET: ã‚µãƒ¼ãƒãƒ¼ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã€ãƒªã‚½ãƒ¼ã‚¹ã‚’å–å¾—
* POST: ã‚µãƒ¼ãƒãƒ¼ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã€ãƒªã‚½ãƒ¼ã‚¹ã®æ›´æ–°ãªã©

**â“ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://127.0.0.1:9000/items` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚‚ `{"message": "item received: <name>"}` ãŒè¿”ã£ã¦ã“ãªã„ã®ã¯ãªãœã§ã—ã‚‡ã†ã‹ï¼Ÿ**
* server.go ã® route ã« GET /items ãŒãªã„ã‹ã‚‰ï¼Ÿ

**â“ã‚¢ã‚¯ã‚»ã‚¹ã—ãŸã¨ãã«è¿”ã£ã¦ãã‚‹HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã„ãã¤ã§ã™ã‹ï¼Ÿ**
* 200 OK

**â“ãã‚Œã¯ã©ã‚“ãªæ„å‘³ã‚’ã‚‚ã¤ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã§ã™ã‹ï¼Ÿ**
* ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ­£å¸¸ã«å‡¦ç†ã•ã‚ŒãŸ

**â“ãƒãƒƒã‚·ãƒ¥åŒ–ã¨ã¯ãªã«ã‹ï¼Ÿ**
* ç‰¹å®šã®ãƒ«ãƒ¼ãƒ«(ãƒãƒƒã‚·ãƒ¥é–¢æ•°)ã«åŸºã¥ã„ã¦å€¤ã‚’å¤‰æ›ã™ã‚‹ã“ã¨

**â“SHA-256 ä»¥å¤–ã«ã©ã‚“ãªãƒãƒƒã‚·ãƒ¥é–¢æ•°ãŒã‚ã‚‹ã‹èª¿ã¹ã¦ã¿ã¾ã—ã‚‡ã†**
* SHA-3, MD5ãªã©
    * ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¨­è¨ˆã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åº¦ã€é€Ÿåº¦ã€ç”¨é€”ãŒé•ã† ã‚‰ã—ã„

**â“Log levelã¨ã¯ï¼Ÿ**
* ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãŒè¨˜éŒ²ã™ã‚‹ãƒ­ã‚°(ã©ã‚“ãªå‹•ä½œãŒè¡Œã‚ã‚ŒãŸã‹ã®è¨˜éŒ²)ã®è©³ç´°åº¦ã¨é‡è¦åº¦ã‚’èª¿æ•´ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿

**â“webã‚µãƒ¼ãƒãƒ¼ã§ã¯ã€æœ¬ç•ªã¯ã©ã®ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã¾ã§è¡¨ç¤ºã™ã‚‹ï¼Ÿ**
* INFOä»¥ä¸ŠãŒä¸€èˆ¬çš„ é–‹ç™ºç’°å¢ƒã ã¨DEBUG

**â“port (ãƒãƒ¼ãƒˆç•ªå·)**
* ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãŒé€šä¿¡ã«ä½¿ç”¨ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ç•ªå· HTTP:80 etc.

**â“localhost, 127.0.0.1**
* localhost: ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼è‡ªèº«ã‚’æŒ‡ã—ç¤ºã™ãŸã‚ã®ãƒ›ã‚¹ãƒˆå
* 127.0.0.1: IPv4ã«ãŠã‘ã‚‹ç‰¹åˆ¥ãªIPã‚¢ãƒ‰ãƒ¬ã‚¹

**â“HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰**
* Webã‚µãƒ¼ãƒãƒ¼ã«ã©ã®ã‚ˆã†ãªå‡¦ç†ã‚’ã™ã‚‹ã‹ã‚’ä¼ãˆã‚‹å½¹å‰²
* GET/POST/PUT(æ›´æ–°)/PATCH(ä¸€éƒ¨æ›´æ–°)/DELETE(å‰Šé™¤)

**â“HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ (1XX, 2XX, 3XX, 4XX, 5XXã¯ãã‚Œãã‚Œã©ã‚“ãªæ„å‘³ã‚’æŒã¡ã¾ã™ã‹ï¼Ÿ)**
* 1XX: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå—ã‘ä»˜ã‘ã‚‰ã‚Œã¦å‡¦ç†ãŒç¶šã„ã¦ã„ã‚‹(Informational)
* 2XX: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæ­£å¸¸ã«å®Œäº†(Success)
* 3XX: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Œäº†ã™ã‚‹ãŸã‚ã«è¿½åŠ ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒå¿…è¦(Redirection)
* 4XX: ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«å•é¡Œã‚ã‚Š(Client Error)
* 5XX: ã‚µãƒ¼ãƒãƒ¼ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã§ããªã‹ã£ãŸ(Server Error)

### STEP5: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

**â“jsonãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ãªããƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹(SQLite)ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹åˆ©ç‚¹ã¯ä½•ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ**
* dbã ã¨ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ãŒã¨ã‚Šã‚„ã™ã„ã€ãƒ‡ãƒ¼ã‚¿æ“ä½œãƒ»æ¤œç´¢ãŒåŠ¹ç‡çš„(jsonã ã¨ãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ã‚’èª­ã‚€è¾¼ã‚€å¿…è¦ãŒã‚ã‚‹)

**â“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ­£è¦åŒ–ã¨ã¯ä½•ã§ã—ã‚‡ã†ã‹ï¼Ÿ**
* ãƒ‡ãƒ¼ã‚¿ã®é‡è¤‡ã‚’æ’é™¤ã—ã€ãƒ‡ãƒ¼ã‚¿ã®æ•´åˆæ€§ã‚’ä¿ã¤ãŸã‚ã®ãƒ—ãƒ­ã‚»ã‚¹
* ã“ã‚Œã¯ç¬¬äºŒæ­£è¦å½¢?

### STEP6: ãƒ†ã‚¹ãƒˆã‚’ç”¨ã„ã¦APIã®æŒ™å‹•ã‚’ç¢ºèªã™ã‚‹

**â“ã“ã®ãƒ†ã‚¹ãƒˆã¯ä½•ã‚’æ¤œè¨¼ã—ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ**
* AddItemRequestã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒæœŸå¾…ã™ã‚‹å½¢å¼ã‹ã‚’ç¢ºèª

**â“`t.Error()` ã¨ `t.Fatal()` ã«ã¯ã€ã©ã®ã‚ˆã†ãªé•ã„ãŒã‚ã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ**
* t.Error() -> ãƒ†ã‚¹ãƒˆå¤±æ•—ã‚’è¨˜éŒ²ã€ãƒ†ã‚¹ãƒˆé–¢æ•°ã®å®Ÿè¡Œã¯ç¶™ç¶š
* t.Fatal() -> ãƒ†ã‚¹ãƒˆå¤±æ•—ã‚’è¨˜éŒ²ã€ãƒ†ã‚¹ãƒˆé–¢æ•°ã®å®Ÿè¡Œã‚’çµ‚äº†(ä¸­æ–­ã‚’ç¤ºã™)

**â“ãƒ¢ãƒƒã‚¯ã‚’æº€ãŸã™ãŸã‚ã«interfaceã‚’ç”¨ã„ã¦ã„ã¾ã™ãŒã€interfaceã®ãƒ¡ãƒªãƒƒãƒˆã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†**
* ãƒ¢ãƒƒã‚¯ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ãŸä»£æ›¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ -> å®Ÿéš›ã®ä¾å­˜é–¢ä¿‚ã‚’æ¨¡å€£ã§ãã‚‹

**â“ãƒ¢ãƒƒã‚¯ã‚’åˆ©ç”¨ã™ã‚‹ãƒ¡ãƒªãƒƒãƒˆã¨ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã«ã¤ã„ã¦è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†**
* å˜ä½“ãƒ†ã‚¹ãƒˆãŒç°¡å˜

### STEP10: docker-composeã‚’åˆ©ç”¨ã—ã¦è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’å‹•ã‹ã™

**â“ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®docker-composeãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã„ãã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿãã‚Œã‚‰ã¯ã©ã®ã‚ˆã†ãªã‚µãƒ¼ãƒ“ã‚¹ã§ã™ã‹ï¼Ÿ**
* 2ã¤(web, redis)
* web: Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æä¾›ã™ã‚‹ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¾ãŸã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã‚µãƒ¼ãƒãƒ¼
* redis: ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢å‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹

**â“webã‚µãƒ¼ãƒ“ã‚¹ã¨redisã‚µãƒ¼ãƒ“ã‚¹ã¯ç•°ãªã‚‹æ–¹æ³•ã§ image ã‚’å–å¾—ã—ã¦ã„ã¾ã™ã€‚docker-compose upã‚’å®Ÿè¡Œã—ãŸéš›ã«ã€å„imageã¯ã©ã“ã‹ã‚‰å–å¾—ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚**
* web: ãƒ­ãƒ¼ã‚«ãƒ«(TagãŒlatestã ã‹ã‚‰)
* rdis: Docker Hub(TagãŒalpineã ã‹ã‚‰)

**â“docker-composeã§ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ä»–ã®ã‚µãƒ¼ãƒ“ã‚¹ã®ã‚³ãƒ³ãƒ†ãƒŠã«æ¥ç¶šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚webã‚µãƒ¼ãƒ“ã‚¹ã¯ã€redisã‚µãƒ¼ãƒ“ã‚¹ã¨ã©ã®ã‚ˆã†ã«åå‰è§£æ±ºã‚’ã—ã€æ¥ç¶šã—ã¦ã„ã¾ã™ã‹ï¼Ÿ**  
* "redis" ã‚’ãƒ›ã‚¹ãƒˆåã¨ã—ã¦è§£æ±º  
* ```$ docker network inspect composetest_default```ã§ç¢ºèª  


## ãªã‚‹ã»ã©
`go run cmd/api/main.go` ã§ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã™ã‚‹ãªã‚‰main.go ã®å®Ÿè¡Œãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ `go/`

ãã‚‚ãã‚‚ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã¨ã¯ -> HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ã‘å–ã‚Šã€é©åˆ‡ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™é–¢æ•°

    step4-4
    	# ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰.jpgã‚’ãƒã‚¹ãƒˆã™ã‚‹
    	$ curl \
    	-X POST \
    	--url 'http://localhost:9000/items' \
    	-F 'name=jacket' \
    	-F 'category=fashion' \
    	-F 'image=@images/local_image.jpg' <-ãƒ­ãƒ¼ã‚«ãƒ«ã®uploadã—ãŸã„iamgeã®ãƒ‘ã‚¹ "image=go/images/default.jpg"ã¨ã‹
 
 r.PathValue ã¨ r.URL.Query().Get
	-> http:/@/127.0.0.1:9000/Path?<query parameter>
	-> r.PathValue: Pathã‚’å–å¾—ã€€/items/{item_id}ã ã¨{item_id}ã‚’å–å¾—ã™ã‚‹
	-> r.URL.Query().Get: ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã€€/search?keyword=jacketã ã¨jacketã‚’å–å¾—

### â– docker(step10)
1. docker desktopã‚’èµ·å‹•  
2. ```docker build -t build2024/web:latest <Dockerfileã®ã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª>```
3. ``` docker run -d -p 3000:3000 build2024/web:latest```

### â– step 8: github actionã«ã¤ã„ã¦
å¤‰æ›´ã‚’commit/pushã—ãŸã‚‰è‡ªå‹•çš„(pushã‚’ãƒˆãƒªã‚¬ãƒ¼ã¨ã—ã¦)ã«build.ymlãŒå®Ÿè¡Œã•ã‚Œã‚‹  
	->docker imageã®ãƒ“ãƒ«ãƒ‰ã¨ã‹  
```https://github.com/yamada3-1990/mercari-build-training/pkgs/container/mercari-build-training```ã«è¡Œãã¨ã‚³ãƒãƒ³ãƒ‰ãŒã‚ã‚‹ã‹ã‚‰å®Ÿè¡Œ  
â†“  
```docker pull ghcr.io/<github-id>/mercari-build-training:<branch-name>```  
pullã§ããŸã‚‰ã‚³ãƒ³ãƒ†ãƒŠã‚’å®Ÿè¡Œ  
â†“  
```docker run -p 9000:9000 ghcr.io/<github-id>/mercari-build-training:<branch-name>```  
â†“   
```start npm```  
â†“  
```http://localhost:3000/```ã§ã‚¢ã‚¯ã‚»ã‚¹  

### â– step10
```mercari-build-training/```ã«ç§»å‹•  
â†“   
```$ docker-compose up --build -d```  
â†“  
```http://localhost:3000/```ã§ç¢ºèª  

### CORSã¨ã¯
* ç•°ãªã‚‹ã‚ªãƒªã‚¸ãƒ³é–“ã§ã®ãƒªã‚½ãƒ¼ã‚¹å…±æœ‰ã‚’è¨±å¯ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿
* é•ã†å ´æ‰€(ã‚ªãƒªã‚¸ãƒ³)ã‹ã‚‰ã‚¦ã‚§ãƒ–ãƒšãƒ¼ã‚¸ãŒãƒ‡ãƒ¼ã‚¿ã‚’ã‚‚ã‚‰ã£ãŸã‚Šé€ã£ãŸã‚Šã§ãã‚‹ã‹ã©ã†ã‹ã‚’æ±ºã‚ã‚‹ãƒ«ãƒ¼ãƒ«ã®ã“ã¨
* Aã€Œãƒ‡ãƒ¼ã‚¿ã‚‚ã‚‰ã£ã¦ã„ã„ï¼Ÿã€Bã€Œã„ã„ã‚ˆã€ã¨ãªã£ãŸã‚‰Bã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒã‚‚ã‚‰ãˆã‚‹


## Link
ğŸ”—[Goã§APIã‹ã‚‰å–å¾—ã—ãŸJSONã‚’5åˆ†ã§ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ - ãºã„](https://tikasan.hatenablog.com/entry/2017/04/26/110854)  
ğŸ”—[goè¨€èª ãƒ•ã‚¡ã‚¤ãƒ«ã®æ‹¡å¼µå­ã®ã¿ã‚’å–å¾—ã™ã‚‹ | mebee](https://mebee.info/2021/05/28/post-23288/)  
ğŸ”—[ä»Šgoã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ç„¡é›£ã«ã—ã¦ãŠãæ–¹æ³•ï¼ˆ2021.09ç¾åœ¨ï¼‰](https://zenn.dev/nekoshita/articles/097e00c6d3d1c9)  
ğŸ”—[Goè¨€èªã§SQLite3ã‚’ä½¿ã†](https://zenn.dev/teasy/articles/go-sqlite3-sample)  
ğŸ”—[ã€Goè¨€èªã€‘database/sqlãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œå…¥é–€ - sqlite3 - Ike Tech Blog](https://iketechblog.com/database-sql-go-sqlite3/)  
ğŸ”—[Binary was compiled with 'CGO_ENABLED=0', go-sqlite3 requires cgo to work.](https://github.com/mattn/go-sqlite3/issues/855)    
ğŸ”—[os package - os - Go Packages](https://pkg.go.dev/os#pkg-variables)  
ğŸ”—[[å…¥é–€]Goã§SQLite3ã‚’ä½¿ã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚’è¡Œã£ã¦ã¿ã‚‹](https://zenn.dev/tara_is_ok/articles/15b04694466bec)  
ğŸ”—[http package - net/http - Go Packages](https://pkg.go.dev/net/http)  
ğŸ”—[go-sqlite3/_example/simple/simple.go at master Â· mattn/go-sqlite3](https://github.com/mattn/go-sqlite3/blob/master/_example/simple/simple.go)  
ğŸ”—[Go database/sql ã®æ“ä½œã‚¬ã‚¤ãƒ‰ã‚ã£ãŸã‚“ã‹ã„](https://sourjp.github.io/posts/go-db/)  
ğŸ”—[mockgenãŒ2023å¹´ï¼–æœˆï¼’ï¼˜æ—¥ã§èª­ã¿å–ã‚Šå°‚ç”¨ã«ãªã£ãŸ](https://zenn.dev/135yshr/articles/6fa5ccc644ba29)    
ğŸ”—[Golangã§DBã‚¢ã‚¯ã‚»ã‚¹ãŒã‚ã‚‹ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ã‚„ã‚Šæ–¹ã‚’è€ƒãˆã‚‹](https://qiita.com/seya/items/582c2bdcca4ad50b03b7)   
ğŸ”—[Docker Compose ã‚’ã¯ã˜ã‚ã‚ˆã†](https://matsuand.github.io/docs.docker.jp.onthefly/compose/gettingstarted/)   
ğŸ”—[ã‚ªãƒªã‚¸ãƒ³é–“ãƒªã‚½ãƒ¼ã‚¹å…±æœ‰ (CORS)](https://developer.mozilla.org/ja/docs/Web/HTTP/CORS)   



